<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript时间循环机制 | corner的前端知识库</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script>var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?2f7c6e1628f708d263ab46ce7fac7777";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
      </script>
    <meta name="description" content="前端学习笔记，个人博客">
    
    <link rel="preload" href="/daydayup-website/assets/css/0.styles.922da580.css" as="style"><link rel="preload" href="/daydayup-website/assets/js/app.29d6866b.js" as="script"><link rel="preload" href="/daydayup-website/assets/js/3.c90bcba9.js" as="script"><link rel="preload" href="/daydayup-website/assets/js/1.63170612.js" as="script"><link rel="preload" href="/daydayup-website/assets/js/14.9fa5dacc.js" as="script"><link rel="prefetch" href="/daydayup-website/assets/js/10.f3d77fde.js"><link rel="prefetch" href="/daydayup-website/assets/js/100.25cef9c8.js"><link rel="prefetch" href="/daydayup-website/assets/js/101.d79bd60b.js"><link rel="prefetch" href="/daydayup-website/assets/js/102.ebc5b56f.js"><link rel="prefetch" href="/daydayup-website/assets/js/103.54ed18f4.js"><link rel="prefetch" href="/daydayup-website/assets/js/104.5c5e100d.js"><link rel="prefetch" href="/daydayup-website/assets/js/105.ffd79948.js"><link rel="prefetch" href="/daydayup-website/assets/js/106.96d8c409.js"><link rel="prefetch" href="/daydayup-website/assets/js/107.743adc55.js"><link rel="prefetch" href="/daydayup-website/assets/js/108.6e5f46e8.js"><link rel="prefetch" href="/daydayup-website/assets/js/109.54c5e07d.js"><link rel="prefetch" href="/daydayup-website/assets/js/11.59d295cd.js"><link rel="prefetch" href="/daydayup-website/assets/js/110.d8c57c09.js"><link rel="prefetch" href="/daydayup-website/assets/js/111.a570988f.js"><link rel="prefetch" href="/daydayup-website/assets/js/112.9be9db7f.js"><link rel="prefetch" href="/daydayup-website/assets/js/113.061e2200.js"><link rel="prefetch" href="/daydayup-website/assets/js/114.d1e8b0ab.js"><link rel="prefetch" href="/daydayup-website/assets/js/115.393921d3.js"><link rel="prefetch" href="/daydayup-website/assets/js/116.a3c133cc.js"><link rel="prefetch" href="/daydayup-website/assets/js/117.9f2d3bdb.js"><link rel="prefetch" href="/daydayup-website/assets/js/118.40ee6787.js"><link rel="prefetch" href="/daydayup-website/assets/js/119.f122c622.js"><link rel="prefetch" href="/daydayup-website/assets/js/12.ffee1aea.js"><link rel="prefetch" href="/daydayup-website/assets/js/120.f5678ab1.js"><link rel="prefetch" href="/daydayup-website/assets/js/121.8c297cec.js"><link rel="prefetch" href="/daydayup-website/assets/js/122.0ded4732.js"><link rel="prefetch" href="/daydayup-website/assets/js/123.5c6df57a.js"><link rel="prefetch" href="/daydayup-website/assets/js/124.aa18dd69.js"><link rel="prefetch" href="/daydayup-website/assets/js/125.99d8691a.js"><link rel="prefetch" href="/daydayup-website/assets/js/126.e508fd57.js"><link rel="prefetch" href="/daydayup-website/assets/js/127.95aafe3a.js"><link rel="prefetch" href="/daydayup-website/assets/js/128.5d283aac.js"><link rel="prefetch" href="/daydayup-website/assets/js/129.497dc28d.js"><link rel="prefetch" href="/daydayup-website/assets/js/13.50b50ae4.js"><link rel="prefetch" href="/daydayup-website/assets/js/130.5ab25700.js"><link rel="prefetch" href="/daydayup-website/assets/js/131.e1ca442a.js"><link rel="prefetch" href="/daydayup-website/assets/js/15.4c30e1d0.js"><link rel="prefetch" href="/daydayup-website/assets/js/16.093828d8.js"><link rel="prefetch" href="/daydayup-website/assets/js/17.ae959e65.js"><link rel="prefetch" href="/daydayup-website/assets/js/18.ea0aa74d.js"><link rel="prefetch" href="/daydayup-website/assets/js/19.c1c72043.js"><link rel="prefetch" href="/daydayup-website/assets/js/20.8a31278f.js"><link rel="prefetch" href="/daydayup-website/assets/js/21.bfdf5d5b.js"><link rel="prefetch" href="/daydayup-website/assets/js/22.a78073cd.js"><link rel="prefetch" href="/daydayup-website/assets/js/23.693df8d1.js"><link rel="prefetch" href="/daydayup-website/assets/js/24.426989a1.js"><link rel="prefetch" href="/daydayup-website/assets/js/25.ed2a6d55.js"><link rel="prefetch" href="/daydayup-website/assets/js/26.6e12f0e9.js"><link rel="prefetch" href="/daydayup-website/assets/js/27.34cceca3.js"><link rel="prefetch" href="/daydayup-website/assets/js/28.645710cd.js"><link rel="prefetch" href="/daydayup-website/assets/js/29.0c256c45.js"><link rel="prefetch" href="/daydayup-website/assets/js/30.11de2cd6.js"><link rel="prefetch" href="/daydayup-website/assets/js/31.478ac23a.js"><link rel="prefetch" href="/daydayup-website/assets/js/32.44ba8b73.js"><link rel="prefetch" href="/daydayup-website/assets/js/33.9b979b97.js"><link rel="prefetch" href="/daydayup-website/assets/js/34.03cf0cb7.js"><link rel="prefetch" href="/daydayup-website/assets/js/35.18569d87.js"><link rel="prefetch" href="/daydayup-website/assets/js/36.64cf72f0.js"><link rel="prefetch" href="/daydayup-website/assets/js/37.91ebfc5a.js"><link rel="prefetch" href="/daydayup-website/assets/js/38.739e0654.js"><link rel="prefetch" href="/daydayup-website/assets/js/39.0e4867c2.js"><link rel="prefetch" href="/daydayup-website/assets/js/4.ef3c10d6.js"><link rel="prefetch" href="/daydayup-website/assets/js/40.b5496049.js"><link rel="prefetch" href="/daydayup-website/assets/js/41.194e6246.js"><link rel="prefetch" href="/daydayup-website/assets/js/42.346aeda6.js"><link rel="prefetch" href="/daydayup-website/assets/js/43.efb1fdfc.js"><link rel="prefetch" href="/daydayup-website/assets/js/44.23e88737.js"><link rel="prefetch" href="/daydayup-website/assets/js/45.5c2b9aa6.js"><link rel="prefetch" href="/daydayup-website/assets/js/46.70ff6085.js"><link rel="prefetch" href="/daydayup-website/assets/js/47.228da532.js"><link rel="prefetch" href="/daydayup-website/assets/js/48.587943ef.js"><link rel="prefetch" href="/daydayup-website/assets/js/49.79c809e0.js"><link rel="prefetch" href="/daydayup-website/assets/js/5.578a4be4.js"><link rel="prefetch" href="/daydayup-website/assets/js/50.0b6add05.js"><link rel="prefetch" href="/daydayup-website/assets/js/51.d2f12345.js"><link rel="prefetch" href="/daydayup-website/assets/js/52.3cb4213a.js"><link rel="prefetch" href="/daydayup-website/assets/js/53.e9183bcb.js"><link rel="prefetch" href="/daydayup-website/assets/js/54.81b45a6f.js"><link rel="prefetch" href="/daydayup-website/assets/js/55.ad63ca91.js"><link rel="prefetch" href="/daydayup-website/assets/js/56.a7e64a10.js"><link rel="prefetch" href="/daydayup-website/assets/js/57.511d9083.js"><link rel="prefetch" href="/daydayup-website/assets/js/58.5b52ccca.js"><link rel="prefetch" href="/daydayup-website/assets/js/59.0b0861f5.js"><link rel="prefetch" href="/daydayup-website/assets/js/6.94440e4f.js"><link rel="prefetch" href="/daydayup-website/assets/js/60.7d0648b2.js"><link rel="prefetch" href="/daydayup-website/assets/js/61.2bf81e59.js"><link rel="prefetch" href="/daydayup-website/assets/js/62.47a9bf71.js"><link rel="prefetch" href="/daydayup-website/assets/js/63.693fa88e.js"><link rel="prefetch" href="/daydayup-website/assets/js/64.992c0557.js"><link rel="prefetch" href="/daydayup-website/assets/js/65.54529b97.js"><link rel="prefetch" href="/daydayup-website/assets/js/66.9a2d0397.js"><link rel="prefetch" href="/daydayup-website/assets/js/67.a3261b71.js"><link rel="prefetch" href="/daydayup-website/assets/js/68.aef8ded2.js"><link rel="prefetch" href="/daydayup-website/assets/js/69.08280cfd.js"><link rel="prefetch" href="/daydayup-website/assets/js/7.42b11ca9.js"><link rel="prefetch" href="/daydayup-website/assets/js/70.6b733236.js"><link rel="prefetch" href="/daydayup-website/assets/js/71.3df2e4f1.js"><link rel="prefetch" href="/daydayup-website/assets/js/72.af9ab820.js"><link rel="prefetch" href="/daydayup-website/assets/js/73.83b190ec.js"><link rel="prefetch" href="/daydayup-website/assets/js/74.04ab260a.js"><link rel="prefetch" href="/daydayup-website/assets/js/75.e4e292e8.js"><link rel="prefetch" href="/daydayup-website/assets/js/76.8a6ce222.js"><link rel="prefetch" href="/daydayup-website/assets/js/77.e88369e5.js"><link rel="prefetch" href="/daydayup-website/assets/js/78.1649456c.js"><link rel="prefetch" href="/daydayup-website/assets/js/79.03090549.js"><link rel="prefetch" href="/daydayup-website/assets/js/8.4e5001d6.js"><link rel="prefetch" href="/daydayup-website/assets/js/80.dacbfb96.js"><link rel="prefetch" href="/daydayup-website/assets/js/81.dbbedef6.js"><link rel="prefetch" href="/daydayup-website/assets/js/82.7039f781.js"><link rel="prefetch" href="/daydayup-website/assets/js/83.228c498a.js"><link rel="prefetch" href="/daydayup-website/assets/js/84.3c32229f.js"><link rel="prefetch" href="/daydayup-website/assets/js/85.fe8002ce.js"><link rel="prefetch" href="/daydayup-website/assets/js/86.b8cedc60.js"><link rel="prefetch" href="/daydayup-website/assets/js/87.375d7741.js"><link rel="prefetch" href="/daydayup-website/assets/js/88.e6dd1644.js"><link rel="prefetch" href="/daydayup-website/assets/js/89.bd1f973c.js"><link rel="prefetch" href="/daydayup-website/assets/js/9.774ca333.js"><link rel="prefetch" href="/daydayup-website/assets/js/90.153b7bc1.js"><link rel="prefetch" href="/daydayup-website/assets/js/91.1714edf1.js"><link rel="prefetch" href="/daydayup-website/assets/js/92.9880460a.js"><link rel="prefetch" href="/daydayup-website/assets/js/93.bcc714b4.js"><link rel="prefetch" href="/daydayup-website/assets/js/94.716081c8.js"><link rel="prefetch" href="/daydayup-website/assets/js/95.ea5be05b.js"><link rel="prefetch" href="/daydayup-website/assets/js/96.ddd1f30e.js"><link rel="prefetch" href="/daydayup-website/assets/js/97.98fcabcc.js"><link rel="prefetch" href="/daydayup-website/assets/js/98.efeafa0f.js"><link rel="prefetch" href="/daydayup-website/assets/js/99.fdeca923.js">
    <link rel="stylesheet" href="/daydayup-website/assets/css/0.styles.922da580.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>corner的前端知识库</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>前端学习笔记，个人博客</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <!---->
          2023
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/daydayup-website/" class="home-link router-link-active"><!----> <span class="site-name">corner的前端知识库</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/daydayup-website/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      关于我
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/adjfks" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1574934799719240" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/laplacepoisson?spm=1011.2415.3001.5343" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><!----> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>88</h3> <h6 data-v-39576ba9>文章</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>0</h3> <h6 data-v-39576ba9>标签</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/daydayup-website/" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      关于我
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/adjfks" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/1574934799719240" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/laplacepoisson?spm=1011.2415.3001.5343" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><a href="/daydayup-website/" aria-current="page" class="sidebar-link">daydayup</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Interview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/daydayup-website/JavaScript/Function.html" class="sidebar-link">Function.md</a></li><li><a href="/daydayup-website/JavaScript/bind的模拟实现.html" class="sidebar-link">bind的模拟实现.md</a></li><li><a href="/daydayup-website/JavaScript/call和apply的模拟实现.html" class="sidebar-link">call和apply的模拟实现.md</a></li><li><a href="/daydayup-website/JavaScript/instanceof和typeof的实现原理.html" class="sidebar-link">instanceof和typeof的实现原理.md</a></li><li><a href="/daydayup-website/JavaScript/javascript中的作用域和执行上下文.html" class="sidebar-link">javascript中的作用域和执行上下文.md</a></li><li><a href="/daydayup-website/JavaScript/javascript事件循环机制.html" class="active sidebar-link">javascript事件循环机制.md</a></li><li><a href="/daydayup-website/JavaScript/javascript多种继承方式及其优缺点.html" class="sidebar-link">javascript多种继承方式及其优缺点.md</a></li><li><a href="/daydayup-website/JavaScript/new操作符.html" class="sidebar-link">new操作符.md</a></li><li><a href="/daydayup-website/JavaScript/从ECMAScript解读this.html" class="sidebar-link">从ECMAScript解读this.md</a></li><li><a href="/daydayup-website/JavaScript/变量对象与作用域链.html" class="sidebar-link">变量对象与作用域链.md</a></li><li><a href="/daydayup-website/JavaScript/散列哈希.html" class="sidebar-link">散列哈希.md</a></li><li><a href="/daydayup-website/JavaScript/柯里化.html" class="sidebar-link">柯里化.md</a></li><li><a href="/daydayup-website/JavaScript/浮点数精度.html" class="sidebar-link">浮点数精度.md</a></li><li><a href="/daydayup-website/JavaScript/深入理解Generator.html" class="sidebar-link">深入理解Generator.md</a></li><li><a href="/daydayup-website/JavaScript/立即执行函数IIFE.html" class="sidebar-link">立即执行函数IIFE.md</a></li><li><a href="/daydayup-website/JavaScript/通过ECMA262理解抽象相等比较算法.html" class="sidebar-link">通过ECMA262理解抽象相等比较算法.md</a></li><li><a href="/daydayup-website/JavaScript/闭包和虽死犹存的函数.html" class="sidebar-link">闭包和虽死犹存的函数.md</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Life</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js_series</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>series</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vite</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>动手实践</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>小程序</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>手写系列</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>软实力</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2></h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <!---->
          2023
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">JavaScript时间循环机制</h1> <div data-v-f875f3fc><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="javascript时间循环机制"><a href="#javascript时间循环机制" class="header-anchor">#</a> JavaScript时间循环机制</h1> <h2 id="什么是事件循环"><a href="#什么是事件循环" class="header-anchor">#</a> 什么是事件循环？</h2> <p>JS引擎是<strong>单线程</strong>的，直白来说就是一个时间点下JS引擎只能去做一件事情，而Java这种多线程语言，可以同时做几件事情。</p> <p>JS做的任务分为<strong>同步</strong>和<strong>异步</strong>两种，所谓 &quot;异步&quot;，简单说就是一个任务不是连续完成的，先执行第一段，等做好了准备，再回过头执行第二段，第二段也被叫做回调；同步则是连贯完成的。</p> <ul><li>举例：像<strong>读取文件</strong>、<strong>网络请求</strong>这种任务属于异步任务：花费时间很长，但中间的操作不需要JS引擎自己完成，它只用等别人准备好了，把数据给他，他再继续执行回调部分。如果没有特殊处理，JS引擎在执行异步任务时，应该是存在等待的，不去做任何其他事情。</li></ul> <p>js采取了<strong>异步任务回调通知</strong>的模式</p> <ul><li>在等待异步任务准备的同时，JS引擎去执行其他同步任务，等到异步任务准备好了，再去执行回调。这种模式的优势显而易见，完成相同的任务，花费的时间大大减少，这种方式也被叫做<strong>非阻塞式</strong>。</li> <li>而实现这个“通知”的，正是<strong>事件循环</strong>，把异步任务的回调部分交给事件循环，等时机合适交还给JS线程执行。事件循环并不是JavaScript首创的，它是计算机的一种运行机制。</li> <li>事件循环是由一个队列组成的，异步任务的回调遵循先进先出，在JS引擎空闲时会一轮一轮地被取出，所以被叫做循环。</li> <li>根据队列中任务的不同，分为宏任务和微任务。</li></ul> <h2 id="宏任务和微任务"><a href="#宏任务和微任务" class="header-anchor">#</a> 宏任务和微任务</h2> <p>当同步代码执行完毕，查看微任务队列是否有任务，有的话就先把微任务队列中的任务执行完，没有的话就取一个宏任务来执行，执行完毕后又去看微任务队列有没有任务，如此构成了一个循环。</p> <p>宏任务：</p> <ul><li><p>script（整体代码）</p></li> <li><p>setTimout / setInterval</p></li> <li><p>setImmediate(node 独有)</p></li> <li><p>requestAnimationFrame(浏览器独有)</p></li> <li><p>IO</p></li> <li><p>UI render（浏览器独有）</p></li></ul> <p>微任务</p> <ul><li><p>process.nextTick(node 独有)</p></li> <li><p>Promise.then()</p></li> <li><p>Object.observe</p></li> <li><p>MutationObserver</p></li></ul> <h2 id="浏览器的事件循环"><a href="#浏览器的事件循环" class="header-anchor">#</a> 浏览器的事件循环</h2> <ul><li><p>浏览器的事件循环由<strong>一个宏任务队列</strong>+<strong>多个微任务队列</strong>组成。</p> <ul><li>宏任务队列只有一个，而每一个宏任务都有一个自己的微任务队列，每轮循环都是由一个宏任务+多个微任务组成。</li></ul></li> <li><p>首先，执行第一个宏任务：全局Script脚本。产生的的宏任务和微任务进入各自的队列中。执行完Script后，把当前的微任务队列清空。完成一次事件循环。</p></li> <li><p>接着再取出一个宏任务，同样把在此期间产生的回调入队。再把当前的微任务队列清空。以此往复。</p></li> <li><p>下面的Demo展示了微任务的插队过程：</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'第一个回调函数：微任务1'</span><span class="token punctuation">)</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'第三个回调函数：宏任务2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'第二个回调函数：宏任务1'</span><span class="token punctuation">)</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'第四个回调函数：微任务2'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">// 第一个回调函数：微任务1</span>
<span class="token comment">// 第二个回调函数：宏任务1</span>
<span class="token comment">// 第四个回调函数：微任务2</span>
<span class="token comment">// 第三个回调函数：宏任务2</span>

<span class="token comment">//先执行整体代码，然后检查微任务队列，然后取一个宏任务并执行，然后检查并执行完微任务队列所有任务，然后取一个宏任务并执行，循环往复</span>
</code></pre></div><h2 id="node事件循环"><a href="#node事件循环" class="header-anchor">#</a> node事件循环</h2> <p>在node中，事件循环表现出的状态与浏览器中大致相同。不同的是node中有一套自己的模型。node中事件循环的实现是依靠的<strong>libuv引擎。</strong></p> <p>node选择<strong>chrome v8引擎作为js解释器</strong>，v8引擎将js代码分析后去调用对应的node api，而这些api最后则由libuv引擎驱动，执行对应的任务，并把不同的事件放在不同的队列中等待主线程执行。 因此实际上node中的事件循环存在于libuv引擎中。</p> <p>libuv引擎的事件循环模型：</p> <img src="/daydayup-website/assets/img/4.569ca9c1.png"> <ol><li>poll轮询阶段</li></ol> <ul><li><p>先查看poll queue中是否有事件，有任务就按先进先出的顺序依次执行回调。</p></li> <li><p>当queue为空时，会检查是否有<strong>setImmediate()的callback</strong>，如果有就进入check阶段执行这些callback。执行数会受到node的限制，不会无限执行下去。</p></li> <li><p>同时也会检查是否有到期的timer，如果有，就把这些到期的timer的callback按照调用顺序放到timer queue中，之后循环会进入timer阶段执行queue中的 callback。</p></li> <li><p>这两者的顺序是不固定的，受到到代码运行的环境的影响。如果两者的queue都是空的，那么loop会在poll阶段停留，直到有一个i/o事件返回，循环会进入i/o callback阶段并立即执行这个事件的callback。</p></li></ul> <ol start="2"><li>check阶段</li></ol> <p>专门用来执行<code>setImmediate()</code>方法的回调。</p> <ol start="3"><li>close阶段</li></ol> <p>当一个socket连接或者一个handle被突然关闭时（例如调用了<code>socket.destroy()</code>方法），close事件会被发送到这个阶段执行回调。否则事件会用<code>process.nextTick（）</code>方法发送出去。</p> <ol start="4"><li>timer阶段</li></ol> <p>执行setTimeout或者setInterval函数设置的回调函数。</p> <ol start="5"><li>I/O Callback</li></ol> <p>执行I/O事件的回调。</p> <h2 id="process-nexttick"><a href="#process-nexttick" class="header-anchor">#</a> process.nextTick()</h2> <p>实际上node中存在着一个特殊的队列，即nextTick queue。</p> <p>这个队列中的回调会在每次进入新阶段前优先执行，直到该队列清空，因此错误使用process.nextTick()可能导致死循环直到内存溢出。</p> <h2 id="setimmediate"><a href="#setimmediate" class="header-anchor">#</a> setImmediate()</h2> <p>字面意思表示立即执行，实际却是在特点阶段即poll阶段执行。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'immediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面的代码执行顺序无法确定，但是在I/O事件的回调中顺序是固定的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>__filename<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'immediate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// immediate</span>
<span class="token comment">// timeout</span>
</code></pre></div><p><strong>记住：在I/O事件的回调中，setImmediate方法的回调永远在timer的回调前执行。</strong></p></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/daydayup-website/JavaScript/javascript中的作用域和执行上下文.html" class="prev">
            javascript中的作用域和执行上下文.md
          </a></span> <span class="next"><a href="/daydayup-website/JavaScript/javascript多种继承方式及其优缺点.html">
            javascript多种继承方式及其优缺点.md
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/daydayup-website/JavaScript/javascript%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6.html#什么是事件循环" class="sidebar-link reco-side-什么是事件循环" data-v-cb1513f6>什么是事件循环？</a></li><li class="level-2" data-v-cb1513f6><a href="/daydayup-website/JavaScript/javascript%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6.html#宏任务和微任务" class="sidebar-link reco-side-宏任务和微任务" data-v-cb1513f6>宏任务和微任务</a></li><li class="level-2" data-v-cb1513f6><a href="/daydayup-website/JavaScript/javascript%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6.html#浏览器的事件循环" class="sidebar-link reco-side-浏览器的事件循环" data-v-cb1513f6>浏览器的事件循环</a></li><li class="level-2" data-v-cb1513f6><a href="/daydayup-website/JavaScript/javascript%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6.html#node事件循环" class="sidebar-link reco-side-node事件循环" data-v-cb1513f6>node事件循环</a></li><li class="level-2" data-v-cb1513f6><a href="/daydayup-website/JavaScript/javascript%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6.html#process-nexttick" class="sidebar-link reco-side-process-nexttick" data-v-cb1513f6>process.nextTick()</a></li><li class="level-2" data-v-cb1513f6><a href="/daydayup-website/JavaScript/javascript%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6.html#setimmediate" class="sidebar-link reco-side-setimmediate" data-v-cb1513f6>setImmediate()</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/daydayup-website/assets/js/app.29d6866b.js" defer></script><script src="/daydayup-website/assets/js/3.c90bcba9.js" defer></script><script src="/daydayup-website/assets/js/1.63170612.js" defer></script><script src="/daydayup-website/assets/js/14.9fa5dacc.js" defer></script>
  </body>
</html>
